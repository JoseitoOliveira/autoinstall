# Autoinstall for Ubuntu 24.04 (Server ISO -> minimal GUI)

version: 1
identity:
  hostname: ocm-fw
  username: ocm
  password: "$y$j9T$uhkxlm8nUQaNu.6rl4k2d.$DIldpYy96OHg8lFjfXfc671BZcGWkPOmaDONGAhGSg3"

ssh:
  install-server: true
  allow-pw: true
  ssh_pwauth: true

locale: en_US.UTF-8
keyboard:
  layout: br
timezone: America/Sao_Paulo

packages:
  - build-essential
  - git
  - openjdk-17-jdk
  - cmake
  - ninja-build
  - gdb
  - gnome-session
  - gdm3
  - openssh-server
  - nano

late-commands:
  # SSH configuration: enable password login and custom port 2222
  - curtin in-target -- sed -i 's/^#PasswordAuthentication no/PasswordAuthentication yes/' /etc/ssh/sshd_config
  - curtin in-target -- sed -i 's/^#Port 22/Port 2222/' /etc/ssh/sshd_config
  - curtin in-target -- systemctl enable ssh
  - curtin in-target -- systemctl restart ssh

user-data:
  disable_root: true

updates: security
debconf-selections: |
  gdm3 shared/default-x-display-manager select gdm3

reporting:
  hook:
    type: print
  builtin:
    type: print

shutdown: reboot
